<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="utf-8">
  <title>SPLAT Business Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/socket.io-client@4/dist/socket.io.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { background: linear-gradient(to bottom right, #581c87, #000, #1f2937); color: #f9fafb; font-family: system-ui; min-height: 100vh; }
    .container { max-width: 80rem; margin: 0 auto; padding: 2rem; }
    h1 { text-align: center; background: linear-gradient(to right, #c084fc, #ec4899); -webkit-background-clip: text; background-clip: text; color: transparent; font-size: 3rem; font-weight: bold; margin-bottom: 3rem; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; }
    .card { background: rgba(0,0,0,0.4); backdrop-filter: blur(10px); border: 1px solid rgba(139,92,246,0.3); padding: 2.5rem; border-radius: 1.5rem; }
    h2 { font-size: 1.875rem; margin-bottom: 2rem; }
    select, input { width: 100%; padding: 1rem; background: #1f2937; border-radius: 0.75rem; border: 1px solid #374151; color: #f9fafb; font-size: 1.125rem; margin-bottom: 1rem; }
    button { width: 100%; padding: 1.5rem; background: linear-gradient(to right, #9333ea, #ec4899); border: none; border-radius: 0.75rem; color: white; font-size: 1.25rem; font-weight: bold; cursor: pointer; transition: transform 0.2s; }
    button:hover { transform: scale(1.02); }
    .status { margin-top: 1.5rem; font-size: 1.25rem; padding: 1rem; background: #1f2937; border-radius: 0.5rem; }
    .quote-card { padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; }
    .active { background: rgba(139,92,246,0.2); border-color: #a78bfa; }
    .hash { font-family: monospace; word-break: break-all; font-size: 0.875rem; color: #60a5fa; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const API = 'https://ramplayer-core-2025-production-c338.up.railway.app';
    function App() {
      const [balance, setBalance] = useState(50000);
      const [quotes, setQuotes] = useState({});
      const [selected, setSelected] = useState({ exchange: 'virgocx', token: 'USDC', amount: 10000, direction: 'sell' });
      const [status, setStatus] = useState('Ready');
      const [txHash, setTxHash] = useState('');
      useEffect(() => {
        axios.get(API + '/quotes').then(r => setQuotes(r.data.quotes));
        const socket = io(API);
        socket.on('tx-update', d => {
          setStatus(`Confirmed – ${d.confirmations}/12`);
          setTxHash(d.hash);
        });
        return () => socket.close();
      }, []);
      const execute = async () => {
        setStatus('Processing...');
        try {
          const res = await axios.post(API + '/transaction', selected);
          setBalance(res.data.newBalance);
          setStatus(`Success – Fee: $${res.data.fee}`);
          setTxHash(res.data.hash);
        } catch (e) {
          setStatus('Failed');
        }
      };
      return (
        <div className="container">
          <h1>SPLAT Business Dashboard</h1>
          <div className="grid">
            <div className="card">
              <h2>Execute Trade</h2>
              <div className="text-2xl mb-6">Balance: <span className="text-green-400 font-bold">${balance.toLocaleString()} CAD</span></div>
              <select value={selected.exchange} onChange={e => setSelected({...selected, exchange: e.target.value})} className="text-xl">
                <option value="newton">Newton</option>
                <option value="virgocx">VirgoCX</option>
                <option value="bitbuy">Bitbuy</option>
              </select>
              <select value={selected.token} onChange={e => setSelected({...selected, token: e.target.value})} className="text-xl">
                <option>USDC</option>
                <option>USDT</option>
                <option>BTC</option>
              </select>
              <input type="number" value={selected.amount} onChange={e => setSelected({...selected, amount: Number(e.target.value)})} className="text-xl" />
              <button onClick={execute}>EXECUTE {selected.direction.toUpperCase()}</button>
              <div className="status">{status}</div>
              {txHash && <div className="hash">Tx: {txHash}</div>}
            </div>
            <div className="card">
              <h2>Live Quotes (CAD)</h2>
              {Object.entries(quotes).map(([lp, rates]) => (
                <div key={lp} className={`quote-card ${selected.exchange === lp ? 'active' : ''}`}>
                  <p className="font-bold text-xl capitalize">{lp}</p>
                  <div className="grid grid-cols-3 gap-4 mt-3 text-lg">
                    <div>USDC <br /><span className="text-2xl font-bold">{rates.USDC}</span></div>
                    <div>USDT <br /><span className="text-2xl font-bold">{rates.USDT}</span></div>
                    <div>BTC <br /><span className="text-2xl font-bold">{rates.BTC.toLocaleString()}</span></div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    }
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
