<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>SPLAT Business Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { background: #000; color: #fff; font-family: system-ui; min-height: 100vh; padding: 2rem; }
    .container { max-width: 80rem; margin: 0 auto; }
    h1 { text-align: center; font-size: 3rem; background: linear-gradient(to right, #c084fc, #ec4899); -webkit-background-clip: text; background-clip: text; color: transparent; margin-bottom: 2rem; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
    .card { background: rgba(31,41,55,0.8); padding: 2rem; border-radius: 1rem; border: 1px solid #4f46e5; }
    h2 { font-size: 1.5rem; margin-bottom: 1rem; }
    select, input { width: 100%; padding: 1rem; background: #1f2937; border: 1px solid #4b5563; border-radius: 0.5rem; color: #fff; margin-bottom: 1rem; }
    button { width: 100%; padding: 1rem; background: #7c3aed; border: none; border-radius: 0.5rem; color: white; font-size: 1.125rem; cursor: pointer; }
    button:hover { background: #6d28d9; }
    .status { margin-top: 1rem; padding: 1rem; background: #1f2937; border-radius: 0.5rem; }
    .quote { padding: 1rem; margin-bottom: 1rem; border-radius: 0.5rem; background: #1f2937; }
    .active { border-color: #7c3aed; background: #4f46e5; }
    .hash { font-family: monospace; word-break: break-all; color: #60a5fa; font-size: 0.875rem; margin-top: 1rem; }
  </style>
</head>
<body>
  <div class="container">
    <h1>SPLAT Business Dashboard</h1>
    <div class="grid">
      <div class="card">
        <h2>Execute Trade</h2>
        <p class="text-2xl mb-4">Balance: <span class="text-green-400 font-bold">$50,000 CAD</span></p>
        <select id="lp">
          <option value="newton">Newton</option>
          <option value="virgocx">VirgoCX</option>
          <option value="bitbuy">Bitbuy</option>
        </select>
        <select id="token">
          <option>USDC</option>
          <option>USDT</option>
          <option>BTC</option>
        </select>
        <input type="number" id="amount" value="10000" placeholder="Amount">
        <button onclick="executeTrade()">EXECUTE SELL</button>
        <div id="status" class="status">Ready</div>
        <div id="hash" class="hash"></div>
      </div>
      <div class="card">
        <h2>Live Quotes (CAD)</h2>
        <div id="quotes"></div>
      </div>
    </div>
  </div>
  <script>
    const API = 'https://ramplayer-core-2025-production-c338.up.railway.app';
    let balance = 50000;
    let quotes = {};

    function loadQuotes() {
      fetch(API + '/quotes').then(r => r.json()).then(data => {
        quotes = data.quotes;
        document.getElementById('quotes').innerHTML = Object.entries(quotes).map(([lp, r]) => `
          <div class="quote ${document.getElementById('lp').value === lp ? 'active' : ''}">
            <p class="font-bold">${lp.toUpperCase()}</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-top: 1rem;">
              <div>USDC: <b>${r.USDC}</b></div>
              <div>USDT: <b>${r.USDT}</b></div>
              <div>BTC: <b>${r.BTC.toLocaleString()}</b></div>
            </div>
          </div>
        `).join('');
      });
    }

    function executeTrade() {
      const lp = document.getElementById('lp').value;
      const token = document.getElementById('token').value;
      const amount = Number(document.getElementById('amount').value);
      document.getElementById('status').innerHTML = 'Processing...';
      fetch(API + '/transaction', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({amountCAD: amount, direction: 'sell', exchange: lp, token})
      }).then(r => r.json()).then(data => {
        balance = data.newBalance;
        document.getElementById('status').innerHTML = `Success â€“ Fee: $${data.fee}`;
        document.getElementById('hash').innerHTML = `Tx: ${data.hash}`;
        document.querySelector('.text-green-400').innerHTML = '$' + balance.toLocaleString() + ' CAD';
        loadQuotes();
      }).catch(() => document.getElementById('status').innerHTML = 'Failed');
    }

    loadQuotes();
  </script>
</body>
</html>
